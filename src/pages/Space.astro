<script>
    import * as THREE from 'three';
    import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
    import { createStars } from '../components/startField.js';
    import { createPlanet } from '../components/planets';

    import {
    jupiterTexture,
    marsTexture,
    mercuryTexture,
    neptuneTexture,
    plutoTexture,
    saturnRingTexture,
    saturnTexture,
    sunTexture,
    uranusRingTexture,
    uranusTexture,
    venusTexture,
    } from "../components/textures";
    import { earthTexture } from '../components/textures';

    const wScreen = window.innerWidth;
    const hScreen = window.innerHeight;
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(45, wScreen / hScreen, 0.1, 1000);
    camera.position.set(0, 400, 0);

    const renderer = new THREE.WebGLRenderer({
        antialias: true,
    });

    renderer.setSize(wScreen, hScreen);
    document.body.appendChild(renderer.domElement);

    new OrbitControls(camera, renderer.domElement);

    // -------
    
    const loader = new THREE.TextureLoader();
    const stars = createStars(scene);

    // -------

    
    const mercury = createPlanet(2, mercuryTexture, 34, null, loader, scene);
    const venus = createPlanet(2.5, venusTexture, 45, null, loader, scene);
    const earth = createPlanet(3, earthTexture, 57, null, loader, scene);
    const mars = createPlanet(2.4, marsTexture, 69, null, loader, scene);
    const jupiter = createPlanet(7, jupiterTexture, 85, null, loader, scene);
    const saturn = createPlanet(6.2, saturnTexture, 110, {innerRadius: 8, outerRadius: 11.5, texture: saturnRingTexture}, loader, scene)
    const uranus = createPlanet(5.8, uranusTexture, 137.5, {innerRadius: 7, outerRadius: 9.5, texture: uranusRingTexture}, loader, scene)
    const neptune = createPlanet(5.3, neptuneTexture, 160, null, loader, scene);
    const pluto = createPlanet(1.7, plutoTexture, 175, null, loader, scene);
    
    // -------

    const sunGeometry = new THREE.IcosahedronGeometry(20, 15);
    const sunMaterial = new THREE.MeshBasicMaterial(
        {map: loader.load(sunTexture)}
    );
    const sunMesh = new THREE.Mesh(sunGeometry, sunMaterial);
    scene.add(sunMesh)

    const pointLight = new THREE.PointLight(0xffffff, 10000, 300);
    scene.add(pointLight);

    function render() {
        requestAnimationFrame(render);

        sunMesh.rotation.y += 0.004;
        stars.rotation.y += 0.0009;

        // rotacion propia
        mercury.planetMesh.rotation.y += 0.004;
        venus.planetMesh.rotation.y += 0.002;
        earth.planetMesh.rotation.y += 0.02;
        mars.planetMesh.rotation.y += 0.018;
        jupiter.planetMesh.rotation.y += 0.004;
        saturn.planetMesh.rotation.y += 0.038;
        uranus.planetMesh.rotation.y += 0.003;
        neptune.planetMesh.rotation.y += 0.032;
        pluto.planetMesh.rotation.y += 0.008;

        // rotacion por el sol
        mercury.planetGroup.rotation.y += 0.02;
        venus.planetGroup.rotation.y += 0.015;
        earth.planetGroup.rotation.y += 0.012;
        mars.planetGroup.rotation.y += 0.01;
        jupiter.planetGroup.rotation.y += 0.0075;
        saturn.planetGroup.rotation.y += 0.005;
        uranus.planetGroup.rotation.y += 0.0025;
        neptune.planetGroup.rotation.y += 0.0015;
        pluto.planetGroup.rotation.y += 0.0012;

        renderer.render(scene, camera)
    }

    render();
    
</script>
